
buildscript {
  repositories {
    mavenLocal()
    maven {
      url 'https://plugins.gradle.org/m2/'
    }
    mavenCentral()
    jcenter()
  }
}

archivesBaseName = "gax"

dependencies {
  compile libraries.guava,
    libraries.jsr305,
    libraries.autovalue,
    libraries.threetenbp,
    libraries.auth,
    libraries.apiCommon

  testCompile libraries.junit,
    libraries.mockito,
    libraries.truth

  apt libraries.autovalue

  shadowNoGuava libraries.guava
}

task createProperties(dependsOn: processResources) << {
  def propertiesDir = "$buildDir/resources/main/com/google/api/gax/"
  new File(propertiesDir).mkdirs()
  Properties p = new Properties()
  p['version'] = project.version.toString()
  p.store(new PrintWriter(propertiesDir + "project.properties", "UTF-8"), null)
}

classes {
  dependsOn createProperties
}
